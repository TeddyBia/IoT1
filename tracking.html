<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Device Control & Camera</title>

  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
    integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />
  <link rel="stylesheet" href="css/tracking.css" />
  <link rel="stylesheet" href="html/navbar.css" />
  <link rel="stylesheet" href="html/header.css" />
  <link rel="stylesheet" href="html/wifi.css" />
</head>

<body>
  <!-- header d√πng chung -->
  <header class="header-blue">
    <div id="navbar"></div>
  </header>

  <section class="hero">
    <h1 class="page-title">Device Control & Camera</h1>
    <p class="page-subtitle">
      Control actuators and monitor live frames from Firebase in real time.
    </p>

    <div class="main-panel">
      <!-- LEFT: CONTROL -->
      <div class="left-col">
        <div class="control-panel glass-card">
          <div class="panel-head">
            <h2 class="panel-title">Actuator Control</h2>
            <p id="status" class="status-pill waiting status-rtdb">
              <span class="dot"></span>
              Connecting
            </p>
          </div>

          <!-- FAN -->
          <div class="slider-box">
            <label for="fanSlider">
              üåÄ Fan
              <span class="value-badge" id="fanValue">--</span>%
            </label>

            <div class="slider-group">
              <input type="range" id="fanSlider" min="0" max="100" value="0" />
              <input type="number" id="fanInput" min="0" max="100" value="0" />
            </div>

            <button id="fanToggle" class="toggle-btn off">Disabled FAN</button>
          </div>

          <!-- LED -->
          <div class="slider-box">
            <label for="ledSlider">
              üí° LED
              <span class="value-badge" id="ledValue">--</span>%
            </label>

            <div class="slider-group">
              <input type="range" id="ledSlider" min="0" max="100" value="0" />
              <input type="number" id="ledInput" min="0" max="100" value="0" />
            </div>

            <button id="ledToggle" class="toggle-btn off">Disabled LED</button>
          </div>

          <!-- PUMP -->
          <div class="slider-box">
            <label for="pumpSlider">
              üöø Pump
              <span class="value-badge" id="pumpValue">--</span>%
            </label>

            <div class="slider-group">
              <input type="range" id="pumpSlider" min="0" max="100" value="0" />
              <input type="number" id="pumpInput" min="0" max="100" value="0" />
            </div>

            <button id="pumpToggle" class="toggle-btn off">Disabled PUMP</button>
          </div>

          <!-- SERVO -->
          <div class="slider-box">
            <label for="servoSlider">
              ‚öôÔ∏è Servo
              <span class="value-badge" id="servoValue">--</span>¬∞
            </label>

            <div class="slider-group">
              <input type="range" id="servoSlider" min="0" max="90" value="0" />
              <input type="number" id="servoInput" min="0" max="90" value="0" />
            </div>

            <button id="servoToggle" class="toggle-btn off">Disabled SERVO</button>
          </div>

          <!-- Misting -->
          <div class="button-group">
            <button id="mistingOn" class="misting-btn on">üíß Turn ON misting</button>
            <button id="mistingOff" class="misting-btn off">üö´ Turn OFF misting</button>
          </div>
        </div>
      </div>

      <!-- RIGHT: CAMERA + DETECT G·ªòP -->
      <div class="right-col">
        <div class="camera-panel glass-card">
          <div class="panel-head">
            <h2 class="panel-title">Live Camera Feed</h2>
            <span id="cameraStatus" class="online-indicator offline">
              <span class="dot"></span>
              Offline
            </span>
          </div>

          <div class="camera-box">
            <img id="cameraFrame" alt="Waiting for image..." />
          </div>

          <p id="frameStatus" class="frame-status">Waiting for frame‚Ä¶</p>

          <!-- detect g·ªôp v√†o d∆∞·ªõi camera -->
          <div class="camera-detect-block">
            <div class="camera-detect-title">
              <i class="fa-solid fa-bug"></i>
              Pest / Worm Detection
            </div>

            <div class="detect-grid">
              <div class="detect-item">
                <span class="detect-label">Cell 1</span>
                <span class="detect-value" id="detect1">--</span>
              </div>
              <div class="detect-item">
                <span class="detect-label">Cell 2</span>
                <span class="detect-value" id="detect2">--</span>
              </div>
              <div class="detect-item">
                <span class="detect-label">Cell 3</span>
                <span class="detect-value" id="detect3">--</span>
              </div>
              <div class="detect-item">
                <span class="detect-label">Cell 4</span>
                <span class="detect-value" id="detect4">--</span>
              </div>
            </div>

            <p id="detectStatus" class="status-pill waiting status-detect">
              <span class="dot"></span>
              Waiting for detection data‚Ä¶
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- JS wifi floating -->
  <div id="wifiMonitor" class="wifi-floating wifi-offline">
    <div class="wifi-circle">
      <span class="wifi-bar bar1"></span>
      <span class="wifi-bar bar2"></span>
      <span class="wifi-bar bar3"></span>
      <span class="wifi-dot"></span>
      <span class="wifi-slash"></span>
    </div>
    <div class="wifi-hint" id="wifiHint">WiFi: offline</div>
  </div>

  <footer>KC326E | Group 6</footer>

  <!-- 1) core firebase -->
  <script type="module" src="html/firebase-core.js"></script>
  <!-- 2) load navbar + logout -->
  <script type="module" src="html/navbar-loader.js"></script>
  <script type="module" src="js/tracking.js"></script>
  <script type="module" src="html/wifi.js"></script>
</body>
</html>
